---
title: Formatter - Library - Docs
---

import { Callout } from 'nextra/components';

# Formatter

The `HelpFormatter` class is the component that handles the formatting of help messages. It can be
instantiated with a [validator](validator.mdx) instance and provides methods to format help messages.

## Help message

The help message is a list of [terminal strings](styles.mdx#terminal-strings) that may contain
control sequences and can be printed in a terminal. There are different ways of obtaining help
messages, as described below.

### Default help

The `formatHelp` method returns a message corresponding to the _default_ option group, which is the
set of options that did not explicitly declare an [option group](options.mdx#group--hide) in their
definition. It accepts no parameter.

### Group help

The `formatGroup` method, a sibling of the above one, returns the help of a specific option group.
The `formatGroups` method, on the other hand, returns a `Map{:ts}` that maps group names to help
messages, including the default group with an empty name. Neither of these methods accept any
parameter.

### Full help

The `formatFull` method returns a help message that includes [help sections](#help-sections), as
will be explained later in this page. It accepts two optional parameters:

- `hide` - an object to configure sections that should not be rendered
- `progName` - the name of the program to use in the default usage message

The `hide` parameter, of type `HideSections`, contains the following set of optional flags:

- `intro` - true to omit the introduction section from the full help
- `usage` - true to omit the usage section from the full help
- `groups` - true if no option group should be displayed in the full help
- `footer` - true to omit the footer section from the full help

## Help entries

Each option definition results in a help entry being included under its respective group in the help
message. An entry is divided into "columns" (not to be confused with terminal columns), each
containing a piece of information, as described below.

### Names column

This column contains the option's names separated by commas. The names are listed in the same order
specified in the [names](options.mdx#names--preferred-name) attribute. Each option name reserves a
"slot" in the corresponding index in this column, and the length of a name slot will be the length
of the largest name in that slot, among all options.

For example, if an option's names are `'-f'{:ts}`, `'-ff'{:ts}`, `''{:ts}` and `'--flag'{:ts}`, the
resulting entry might be formatted as:

```
-f, -ff      --flag
```

Note how the empty string produced whitespace between its neighbors, and the commas were suppressed.

### Parameter column

This column contains either:

- the option [example value](options.mdx#example-value), if present
- the option [parameter name](options.mdx#parameter-name), if present
- the option type (the default), formatted as `<type>`

### Description column

The last column contains the option description and is composed of [help items](#help-items), which
are explained later in this page.

## Default usage

The default usage text is a concise representation of a program's command-line. Here is an example:

{/* cSpell:disable */}

```ansi
demo.js [[95mhelp[0m] [([95m-h[0m|[95m--help[0m)] [([95m-v[0m|[95m--version[0m)]
        [([95m-f[0m|[95m--flag[0m|[95m--no-flag[0m)] [[95mhello[0m]
        [([95m-b[0m|[95m--boolean[0m) [90m<boolean>[0m]
        [([95m-s[0m|[95m--stringRegex[0m) [90m<my string>[0m]
        [([95m-n[0m|[95m--numberRange[0m) [90m<my number>[0m]
        [([95m-se[0m|[95m--stringEnum[0m) [32m'one'[0m]
        [([95m-ne[0m|[95m--numberEnum[0m) [33m1[0m]
        [([95m-ss[0m|[95m--strings[0m) [90m<strings>[0m]
        [([95m-ns[0m|[95m--numbers[0m) [90m<numbers>[0m]
        [[([95m--stringsEnum[0m|[95m--[0m)] [32m'one'[0m [32m'two'[0m]
        [[95m--numbersEnum[0m [32m'1,2'[0m]
```

{/* cSpell:enable */}

You can use the default text, or provide your own in the help format configuration, as is described
in the next section.

## Help format

In addition to the validator instance, the formatter constructor accepts a `HelpConfig` object that
can be used to customize the message format. This configuration will apply to both help sections and
help entries. It contains a collection of optional properties, as described below.

### Help sections

The `sections` property specifies texts to be used in the various sections of the full help message.
It has the following set of optional properties:

- `intro` - the introduction of the help message. This is the initial section and has no heading.
- `usage` - your CLI usage instructions. It can be either a text or `true{:ts}`, in which case the
  [default usage](#default-usage) text will be rendered instead. This section has a heading that can
  be configured with the `usageHeading` property.
- `footer` - an afterword, copyright notice or external reference. This is the final section and has
  no heading.
- `usageHeading` - the text of the usage section heading (defaults to `'Usage'{:ts}`)
- `groupHeading` - the text of the default option group heading (defaults to `'Options'{:ts}`)

<Callout type="default">
  All of these properties can include inline styles and will be formatted according to [text
  formatting](styles.mdx#text-splitting) rules, unless `misc.noWrap` is set.
</Callout>

### Indentation level

The `indent` property specifies the indentation levels (in number of terminal columns) of help
sections and of entry columns. It has the following set of optional properties:

- `intro` - level of indentation for the introduction section (non-negative, defaults to `0{:ts}`)
- `usage` - level of indentation for the usage section text (non-negative, defaults to `2{:ts}`)
- `footer` - level of indentation for the footer section (non-negative, defaults to `0{:ts}`)
- `names` - level of indentation for the option names (non-negative, defaults to `2{:ts}`)
- `param` - level of indentation for the option parameter (non-negative if `paramAbsolute` is
  `true{:ts}`, defaults to `2{:ts}`)
- `descr` - level of indentation for the option description (non-negative if `descrAbsolute` is
  `true{:ts}`, defaults to `2{:ts}`)
- `usageOptions` - level of indentation for the options in the [default usage](#default-usage)
  (non-negative if `usageOptionsAbsolute` is `true{:ts}`, defaults to `1{:ts}`)
- `usageHeading` - level of indentation for the usage section heading (non-negative, defaults to
  `0{:ts}`)
- `groupHeading` - level of indentation for every option group heading (non-negative, defaults to
  `0{:ts}`)
- `paramAbsolute` whether the indentation level for the option parameter should be relative to the
  beginning of the line instead of the end of the option names (defaults to `false{:ts}`)
- `descrAbsolute` whether the indentation level for the option description should be relative to the
  beginning of the line instead of the end of the option parameter (defaults to `false{:ts}`)
- `usageOptionsAbsolute` whether the indentation level for the usage options should be relative to
  the beginning of the line instead of the end of the program name (defaults to `false{:ts}`)

### Line breaks

The `breaks` property specifies the number of line breaks to insert before help sections or entry
columns. It has the following set of optional properties:

- `intro` - line breaks to insert before the introduction section (defaults to `0{:ts}`)
- `usage` - line breaks to insert before the usage section text (defaults to `2{:ts}`)
- `groups` - line breaks to insert before each option group content (defaults to `2{:ts}`)
- `footer` - line breaks to insert before the footer section (defaults to `2{:ts}`)
- `names` - line breaks to insert before the option names (defaults to `0{:ts}`)
- `param` - line breaks to insert before the option parameter (defaults to `0{:ts}`)
- `descr` - line breaks to insert before the option description (defaults to `0{:ts}`)
- `usageOptions` - line breaks to insert before the options in the [default usage](#default-usage)
  (defaults to `0{:ts}`)
- `usageHeading` - line breaks to insert before the usage section heading (defaults to `2{:ts}`)
- `groupHeading` - line breaks to insert before every option group heading (defaults to `2{:ts}`)

### Hidden columns

The `hidden` property can be used to select help entry columns that should be omitted. It has the
following set of optional properties:

- `names` - whether option names should be omitted (defaults to `false{:ts}`)
- `param` - whether option parameters should be omitted (defaults to `false{:ts}`)
- `descr` - whether option descriptions should be omitted (defaults to `false{:ts}`)

<Callout type="info">
  These settings do not apply to the [default usage](#default-usage) text.
</Callout>

### Help items

The `items` property specifies the kinds of items that should be displayed in option descriptions,
and in what order. It is an array whose values can be one of the enumerators from `HelpItem`:

- `synopsis` - the option synopsis
- `negation` - the negation names of a flag option, if any
- `separator` - the element delimiter of an array option, if enabled
- `variadic` - reports if an array option accepts multiple parameters
- `positional` - reports if an option accepts positional arguments
- `append` - reports if an array option can be specified multiple times
- `trim` - reports if string parameters will be trimmed (have leading and trailing whitespace removed)
- `case` - the kind of case-conversion applied to string parameters, if enabled
- `round` - the kind of rounding applied to number parameters, if enabled
- `enums` - the enumerated values that the option accepts as parameters, if any
- `regex` - the regular expression that string parameters should match, if enabled
- `range` - the numeric range that number parameters should be within, if enabled
- `unique` - reports if duplicate elements will be removed from an array option value
- `limit` - the element count limit of an array option, if enabled
- `requires` - the option requirements, if any
- `required` - reports if the option is always required
- `default` - the option's default value, if not a callback
- `deprecated` - reports if the option is deprecated, and why
- `link` - the external resource reference, if any
- `envVar` - the option's environment variable, if any
- `requiredIf` - the option's conditional requirements, if any

The default is to print all items in the order listed above.

### Help phrases

The `phrases` property specifies phrases to be used for each kind of help item. If an item has a
value, the `%s` specifier can be used to indicate where in the phrase to place the value. If an item
has multiple alternatives, such as `HelpItem.case`, different texts can separated with `'|'{:ts}`
and grouped in parentheses, as can be seen in the default values listed below:

- `synopsis` - `'%s'{:ts}`
- `negation` - `'Can be negated with %s.'{:ts}`
- `separator` - `'Values are delimited by %s.'{:ts}`
- `variadic` - `'Accepts multiple parameters.'{:ts}`
- `positional` - `'Accepts positional parameters(| that may be preceded by %s).'{:ts}`
- `append` - `'May be specified multiple times.'{:ts}`
- `trim` - `'Values will be trimmed.'{:ts}`
- `case` - `'Values will be converted to (lowercase|uppercase).'{:ts}`
- `round` - `'Values will be rounded (towards zero|down|up|to the nearest integer).'{:ts}`
- `enums` - `'Values must be one of %s.'{:ts}`
- `regex` - `'Values must match the regex %s.'{:ts}`
- `range` - `'Values must be in the range %s.'{:ts}`
- `unique` - `'Duplicate values will be removed.'{:ts}`
- `limit` - `'Value count is limited to %s.'{:ts}`
- `requires` - `'Requires %s.'{:ts}`
- `required` - `'Always required.'{:ts}`
- `default` - `'Defaults to %s.'{:ts}`
- `deprecated` - `'Deprecated for %s.'{:ts}`
- `link` - `'Refer to %s for details.'{:ts}`
- `envVar` - `'Can be specified through the %s environment variable.'{:ts}`
- `requiredIf` - `'Required if %s.'{:ts}`

These phrases will be formatted according to [text formatting](styles.mdx#text-splitting) rules.

<Callout type="warning">
  Phrases can contain inline styles, but not in the same word as the `%s` specifier. Otherwise, they
  will mess up the text wrapping. For example, the following phrase is not valid:
  ``` `Requires ${style(tf.bold)}%s`{:ts} ```.
</Callout>

### Section styles

The `styles` property specifies the [styles](styles.mdx#styling-attributes) of the help sections. It
has the following set of optional properties:

- `intro` - the style of the introduction section (defaults to `tf.clear{:ts}`)
- `usage` - the style of the usage section (defaults to `tf.clear{:ts}`)
- `footer` - the style of the footer section (defaults to `tf.clear{:ts}`)
- `usageHeading` - the style of the usage section heading (defaults to `tf.bold{:ts}`)
- `groupHeading` - the style of every option group heading (defaults to `tf.bold{:ts}`)

### Miscellaneous

The `misc` property specifies additional, uncategorized settings. It has the following set of
optional properties:

- `headingPhrase` - a custom phrase to use for all headings (defaults to `'%s:'{:ts}`)
- `noWrap` - whether provided section texts should _not_ be split into words. This allows you to
  format texts however you like, at the expense of not wrapping them (defaults to `false{:ts}`)

## Help styles

Help messages are styled with the same set of styles as
[error messages](validator.mdx#error-styles), except that they may get overriden by (or combined
with) an option's [display styles](options.mdx#display-styles), if present.

<Callout type="default">
  Whitespace around help entries is not styled. For that purpose, you may need to tweak your
  terminal settings.
</Callout>

<Callout type="info">
  Styles are cumulative, i.e., they can be combined with previous styles depending on the kind of
  styling attribute. For instance, if the style of option description is `tf.bold` and the style of
  number values is `fg.yellow`, then any number value that appears in the option description (except
  those embedded in [text attributes](styles.mdx#text-splitting)) is rendered in bold intensity with
  yellow foreground color.
</Callout>
